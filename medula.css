/* =========================================================
   MEDULA — Portal Paciente
   Hoja de estilos global (Desktop-first)
   ========================================================= */

/* -----------------------
   Paleta base (modo día)
   ----------------------- */
:root{
  --brand-1:#29a5ff;          /* azul claro */
  --brand-2:#1560ff;          /* azul profundo */
  --brand-3:#0b4de2;          /* acento oscuro */

  --bg:#f5f7fb;               /* fondo general */
  --surface:#ffffff;          /* tarjetas / inputs */
  --sidehead:#eaf2ff;         /* cabecera sidebar (día) */
  --panel:#e2e8f5;            /* fondo del panel derecho */
  --panel-surface:#f3f6fc;    /* tarjetas dentro del panel derecho */

  --border:#dfe5ef;           /* bordes suaves */
  --muted:#eff2f7;            /* superficies sutiles */

  --text:#0f1b2d;             /* texto principal */
  --text-2:#5a6b87;           /* texto secundario */

  --success:#10b981;
  --danger:#ef4444;

  --radius-lg:16px;
  --shadow:0 10px 28px rgba(8,23,54,.08);
  --focus:0 0 0 3px rgba(21,96,255,.28);

  --base-font:17px;           /* accesible para adultos */
}

/* Tipografía opcional (coloca el archivo si la usas)
@font-face{
  font-family:"Fira Sans";
  src:url("assets/fonts/FiraSans-Variable.woff2") format("woff2-variations");
  font-weight:100 900;
  font-style:normal;
  font-display:swap;
}
*/

html{ font-size:var(--base-font); }
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family:"Fira Sans", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, Noto Sans;
  line-height:1.6;
}

/* -----------------------
   Utilidades layout
   ----------------------- */
.app{ min-width:1280px; height:100vh; display:flex; }
.sidebar{ width:340px; background:var(--surface); border-right:1px solid var(--border); display:flex; flex-direction:column; }
.main{ flex:1; overflow:auto; }
.right{ width:640px; background:var(--panel); border-left:1px solid var(--border); overflow:auto; }

.p-6{padding:24px;} .p-5{padding:20px;} .p-4{padding:16px;}
.space-y-8>*+*{margin-top:32px;} .space-y-7>*+*{margin-top:28px;} .space-y-5>*+*{margin-top:20px;} .space-y-4>*+*{margin-top:16px;} .space-y-3>*+*{margin-top:12px;}
.flex{display:flex;} .items-center{align-items:center;} .between{justify-content:space-between;}
.gap-2{gap:8px;} .gap-3{gap:12px;} .gap-4{gap:16px;}

/* -----------------------
   Sidebar: header
   ----------------------- */
.side-header{ background:var(--sidehead); border-bottom:1px solid var(--border); }
.brand-banner{ display:block; margin:-4px 0 16px; }
.brand-banner img{ display:block; width:100%; height:auto; max-height:88px; object-fit:contain; }

/* Botón de usuario (card clickeable) */
.user-card{
  position:relative; width:100%;
  display:flex; align-items:center; gap:12px;
  padding:12px; border-radius:12px;
  border:1px solid #cfe0ff;
  background:rgba(41,165,255,.12);
  color:var(--text); cursor:pointer; text-align:left;
}
.user-card:hover{ filter:brightness(.98); }
.user-card:focus{ outline:none; box-shadow:var(--focus); }
.user-avatar{
  width:44px;height:44px;border-radius:12px;
  display:flex;align-items:center;justify-content:center;
  font-weight:800; color:#2a6dff; background:rgba(41,165,255,.18);
}
.user-info{ display:grid; gap:2px; }
.user-name{ font-weight:800; }
.user-rut{ font-size:.95rem; opacity:.9; }

/* Enlace invisible para hacer clickable todo el bloque */
.stretched-link{ position:absolute; inset:0; display:block; }

/* -----------------------
   Navegación lateral
   ----------------------- */
nav[aria-label="Secciones"] a{
  display:flex; align-items:center; gap:12px;
  padding:12px 14px; border-radius:12px;
  text-decoration:none; color:var(--text);
  border:1px solid transparent; font-weight:700;
}
nav[aria-label="Secciones"] a:hover{ background:var(--muted); }
nav[aria-label="Secciones"] a.active{
  background:linear-gradient(90deg,var(--brand-1),var(--brand-2));
  color:#fff;
}
.nav-icon{
  width:22px;height:22px;border-radius:8px;
  display:inline-flex;align-items:center;justify-content:center;
  background:rgba(21,96,255,.08); color:#1850ff; font-weight:800;
}

/* Footer del sidebar: botones */
.side-footer .space-y-3>.flex .btn{ flex:1; }
#btn-sync-gcal, #btn-logout{ width:100%; }

/* -----------------------
   Botones
   ----------------------- */
.btn{
  display:inline-flex; align-items:center; gap:10px;
  border:1px solid var(--border); background:#fff; color:var(--text);
  padding:12px 16px; border-radius:12px; cursor:pointer;
  font-weight:700; min-height:44px;
}
.btn:hover{ background:var(--muted); }
.btn-primary{ background:linear-gradient(90deg,var(--brand-1),var(--brand-2)); color:#fff; border-color:transparent; }
.btn-ghost{ background:transparent; }
.btn-outline{ background:#fff; }

/* -----------------------
   Inputs y campos
   ----------------------- */
.field{ display:grid; gap:6px; }
input[type="text"], input[type="date"], input[type="time"], select, textarea{
  border:1px solid var(--border); border-radius:12px;
  padding:12px 14px; font:inherit; background:#fff; color:var(--text);
}
textarea{ min-height:88px; resize:vertical; }
input:focus, select:focus, textarea:focus{ outline:none; box-shadow:var(--focus); }

/* -----------------------
   Tarjetas, badges, tipografía
   ----------------------- */
.card{ background:var(--surface); border:1px solid var(--border); border-radius:var(--radius-lg); box-shadow:var(--shadow); }
.page-title{ font-size:1.6rem; font-weight:800; margin:0; }
.subtitle{ color:var(--text-2); font-size:.95rem; margin:2px 0 0; }

.badge{
  display:inline-flex; align-items:center; gap:6px;
  border:1px solid var(--border); border-radius:999px;
  padding:2px 10px; font-size:.9rem; color:var(--text-2); background:#fff;
}
.badge.ok{ background:#ecfdf5; border-color:#a7f3d0; color:#065f46; }

/* Fecha con branding (mejor contraste) */
.badge-brand{
  background:#e8f1ff; color:#1e3a8a; border-color:#c7d7f5;
}

/* Separadores y rejillas */
.separator{ height:1px; background:var(--border); margin:8px 0; }
.grid-2{ display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:16px; }
.label{ color:var(--text-2); font-size:1rem; margin-bottom:4px; }
.value{ margin:0; font-weight:800; }

/* Filas de historial / medicamentos */
.entry{ display:flex; align-items:flex-start; justify-content:space-between; }
.entry-left{ display:flex; align-items:flex-start; gap:14px; }
.icon-circle{
  width:42px;height:42px;border-radius:12px;
  background:linear-gradient(135deg,var(--brand-1),var(--brand-2));
  color:#fff; display:flex;align-items:center;justify-content:center;font-size:20px;
}
.entry-title{ margin:0; font-weight:800; }

.med-row{ display:flex; align-items:center; justify-content:space-between; }
.pill-icon{
  width:46px;height:46px;border-radius:14px;
  background:linear-gradient(135deg,var(--brand-1),var(--brand-2));
  display:flex;align-items:center;justify-content:center;color:#fff;font-size:22px;
}
.stock p{ margin:0 0 6px; font-weight:800; }
.progress{ width:120px; height:10px; background:#e5e7eb; border-radius:999px; overflow:hidden; }
.progress>span{ display:block; height:100%; background:linear-gradient(90deg,var(--brand-1),var(--brand-2)); }

/* Exámenes */
.doc-icon{
  width:46px;height:46px;border-radius:14px;
  background:rgba(21,96,255,.08); display:flex; align-items:center; justify-content:center;
  color:#1850ff; font-size:20px;
}

/* -----------------------
   Panel derecho – superficies claras (día)
   ----------------------- */
.right .card,
.right .calendar,
.right .cal-cell,
.right .week-col,
.right .list-day,
.right .appt{
  background:var(--panel-surface);
}
.right .count{ background:#e3ebff; color:#1e3a8a; }

/* -----------------------
   Calendario (mes)
   ----------------------- */
.calendar{ background:var(--surface); border:1px solid var(--border); border-radius:var(--radius-lg); box-shadow:var(--shadow); }
.cal-head{
  padding:18px 20px; border-bottom:1px solid var(--border);
  display:flex; align-items:center; justify-content:space-between; gap:16px;
}
.cal-actions{ display:flex; gap:8px; align-items:center; }
.cal-title{ font-weight:800; min-width:220px; text-align:center; }
.cal-toolbar{ display:flex; gap:12px; align-items:center; }

.segmented{ display:inline-flex; border:1px solid var(--border); border-radius:12px; overflow:hidden; background:var(--muted); }
.segmented button{
  border:0; background:transparent; padding:9px 12px; cursor:pointer;
  font-weight:700; color:var(--text); border-right:1px solid var(--border);
}
.segmented button:last-child{ border-right:0; }
.segmented button[aria-pressed="true"]{
  background:#eef5ff; color:#1f3556; box-shadow:inset 0 0 0 1px #cfe0ff;
}

.cal-legend{ display:flex; gap:12px; align-items:center; justify-content:flex-end; padding:8px 16px 0; color:var(--text-2); }
.cal-legend span{ display:inline-flex; align-items:center; gap:8px; font-size:.95rem; }
.cal-dot{ display:inline-block; width:10px; height:10px; border-radius:50%; }
.cal-dot.consulta{ background:rgba(37,99,235,.85); }
.cal-dot.examen{ background:rgba(124,58,237,.85); }
.cal-dot.medicamento{ background:rgba(5,150,105,.85); }

.cal-grid{ display:grid; grid-template-columns:repeat(7,1fr); gap:8px; padding:16px; }
.cal-dow{ font-size:.9rem; color:var(--text-2); text-transform:uppercase; letter-spacing:.05em; text-align:center; padding:6px 0; }
.cal-cell{
  background:var(--surface); border:1px solid var(--border);
  min-height:136px; border-radius:12px; padding:8px; position:relative;
}
.cal-day{ font-size:1rem; color:var(--text-2); }
.events{ margin-top:6px; display:grid; gap:6px; }
.count{
  position:absolute; top:8px; right:8px;
  background:#DCEBFF; color:#1f3556; border:1px solid #c7d7f5;
  border-radius:999px; min-width:22px; height:22px; display:flex; align-items:center; justify-content:center;
  font-size:.85rem; font-weight:800;
}

.cal-event{
  display:block; font-size:.95rem; padding:6px 8px; border-radius:10px;
  border:1px solid #cfe0ff; color:#0d233a; background:#F2F8FF;
}
.cal-event[data-type="consulta"]{ background:rgba(37,99,235,.10); border-color:rgba(37,99,235,.25); color:#1e3a8a; }
.cal-event[data-type="examen"]{ background:rgba(124,58,237,.12); border-color:rgba(124,58,237,.28); color:#4c1d95; }
.cal-event[data-type="medicamento"]{ background:rgba(5,150,105,.12); border-color:rgba(5,150,105,.28); color:#064e3b; }

.flash{ animation:flash 1.6s ease-in-out 1; }
@keyframes flash{
  0%{box-shadow:0 0 0 0 rgba(21,96,255,.6)}
  60%{box-shadow:0 0 0 16px rgba(21,96,255,0)}
  100%{box-shadow:0 0 0 0 rgba(21,96,255,0)}
}

/* Semana */
#weekView{ padding:16px; }
.week-grid{ display:grid; grid-template-columns:repeat(7,1fr); gap:10px; }
.week-col{ background:var(--surface); border:1px solid var(--border); border-radius:12px; padding:10px; min-height:220px; }
.week-col h4{ margin:0 0 8px; font-weight:800; color:var(--text-2); }
.week-item{ margin:8px 0; padding:8px 10px; border-radius:10px; border:1px solid transparent; }
.week-item[data-type="consulta"]{ background:rgba(37,99,235,.10); border-color:rgba(37,99,235,.25); }
.week-item[data-type="examen"]{ background:rgba(124,58,237,.12); border-color:rgba(124,58,237,.28); }
.week-item[data-type="medicamento"]{ background:rgba(5,150,105,.12); border-color:rgba(5,150,105,.28); }

/* Lista */
#listView{ padding:16px; }
.list-day{ margin:8px 0; padding:12px; border:1px solid var(--border); background:var(--surface); border-radius:12px; }
.list-day h4{ margin:0 0 8px; font-weight:800; color:var(--text-2); }

/* Próximas Citas */
.appt{ padding:14px; border:1px solid var(--border); border-radius:14px; background:var(--surface); }
.appt-time{ display:flex; align-items:center; gap:8px; color:var(--text-2); font-weight:700; }
.appt strong{ font-weight:800; }

/* -----------------------
   Buscador global (sticky)
   ----------------------- */
.sr-only{ position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }

/* Ajustado: más separación con la tarjeta anterior */
.global-search{
  position:sticky; top:0; z-index:15;
  background:var(--panel);
  padding-bottom:12px;
  margin-top:16px;          /* <- separa del formulario */
}
/* Si viene justo después de una card, agrega respiro extra */
.right .card + .global-search{
  margin-top:20px;          /* ajustable 16–24px */
}

.global-search__wrap{
  display:flex; align-items:center; gap:10px;
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:12px; padding:10px 12px;
  box-shadow:var(--shadow);
}
.global-search__icon{ font-size:1.1rem; opacity:.8; }
.global-search input{
  width:100%; border:none; background:transparent; padding:6px 4px;
  font:inherit; color:var(--text); outline:none;
}

/* -----------------------
   Alertas
   ----------------------- */
.alert{ border-radius:12px; padding:12px; }
.alert.warn{ background:#fff7ed; border:1px solid #fed7aa; color:#7c2d12; }
.alert.info{ background:#eff6ff; border:1px solid #bfdbfe; color:#1e40af; }
.alert-title{ font-weight:800; }
.alert-text{ margin-top:4px; opacity:.95; }

/* -----------------------
   Accesibilidad / impresión
   ----------------------- */
a:focus,button:focus,input:focus,select:focus,textarea:focus{ outline:none; box-shadow:var(--focus); }
.skip-link{ position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }
.skip-link:focus{ left:16px; top:16px; width:auto; height:auto; padding:8px 12px; z-index:100; background:var(--brand-2); color:#fff; border-radius:8px; }

@media print{
  .sidebar,.right,.segmented,.global-search,.btn,nav[aria-label="Secciones"]{ display:none!important; }
  .app,.main{ width:100%!important; min-width:auto!important; }
  body{ background:#fff; }
}

/* Reduce motion */
@media (prefers-reduced-motion:reduce){
  .flash{ animation:none!important; } *{ scroll-behavior:auto; }
}

/* =========================================================
   MODO NOCHE (sin brillos, alto confort visual)
   ========================================================= */
body.theme-dark{
  --bg:#0f1628;
  --surface:#151a2d;
  --panel:#11162a;
  --panel-surface:#141a2b;
  --sidehead:#151b2f;

  --border:#2a3452;
  --muted:#1a2138;

  --text:#e6e9f4;
  --text-2:#b8c2d6;

  --focus:0 0 0 3px rgba(148,163,184,.35);
}

/* Sidebar header y user card */
body.theme-dark .side-header{ background:var(--sidehead); border-bottom-color:var(--border); }
body.theme-dark .user-card{ border-color:#2a3a5d; background:#1f2b44; color:#d3e3ff; }
body.theme-dark .user-card:hover{ filter:brightness(1.02); }
body.theme-dark .user-avatar{ color:#d8e6ff; background:#243458; }

/* Navegación */
body.theme-dark nav[aria-label="Secciones"] a:hover{ background:#1b2236; }
body.theme-dark .nav-icon{ background:#1b2236; color:#cbd5e1; }

/* Botones */
body.theme-dark .btn, body.theme-dark .btn-outline{
  background:#181e31; color:var(--text); border-color:#242c46;
}
body.theme-dark .btn:hover{ background:#1c2338; }
body.theme-dark .btn-primary{ background:#2a3146; border-color:#2a3146; color:#e5e7eb; }

/* Inputs */
body.theme-dark input[type="text"],
body.theme-dark input[type="date"],
body.theme-dark input[type="time"],
body.theme-dark select,
body.theme-dark textarea{
  background:#1a2138; color:var(--text); border-color:#2a3452;
}

/* Tarjetas y superficies */
body.theme-dark .card,
body.theme-dark .calendar{ background:#151a2d; border-color:#2a3452; }
body.theme-dark .cal-cell,
body.theme-dark .week-col,
body.theme-dark .list-day,
body.theme-dark .appt{ background:#141a2b; border-color:#2a3452; }

/* Contadores y badges */
body.theme-dark .count{ background:#1b2742; color:#cfe3ff; border:1px solid #2a3a5d; }
body.theme-dark .badge{ background:transparent; border-color:#2f3a5a; color:#cbd5e1; }
body.theme-dark .badge-brand{ background:#1c2650; color:#dbe7ff; border-color:#2a3a5d; }

/* Progress */
body.theme-dark .progress{ background:#232a45; }
body.theme-dark .progress>span{ background:#2d3654; }

/* Segmented */
body.theme-dark .segmented{ background:#151b2d; border-color:#2a3452; }
body.theme-dark .segmented button{ color:#b8c2d6; border-right-color:#2a3452; }
body.theme-dark .segmented button[aria-pressed="true"]{
  background:rgba(82,134,197,.18); color:#dbe7f7; box-shadow:inset 0 0 0 1px rgba(82,134,197,.36);
}

/* Buscador global */
body.theme-dark .global-search{ background:var(--panel); }
body.theme-dark .global-search__wrap{ background:#1a2138; border-color:#2a3452; box-shadow:none; }
body.theme-dark .global-search input{ color:var(--text); }

/* Leyenda y puntos */
body.theme-dark .cal-dot.consulta{ background:#4b6ea8!important; }
body.theme-dark .cal-dot.examen{ background:#495f9c!important; }
body.theme-dark .cal-dot.medicamento{ background:#3a7a86!important; }

/* Eventos (chips) — celestes/violetas suaves, sin fatiga */
body.theme-dark .cal-event,
body.theme-dark .week-item{
  background:#141b2a!important; border-color:#253354!important; color:#dbe7f7!important;
}
body.theme-dark .cal-event[data-type="consulta"],
body.theme-dark .week-item[data-type="consulta"]{
  background:rgba(82,134,197,.18)!important; border-color:rgba(82,134,197,.36)!important; color:#d9e7ff!important;
}
body.theme-dark .cal-event[data-type="examen"],
body.theme-dark .week-item[data-type="examen"]{
  background:rgba(94,118,190,.16)!important; border-color:rgba(94,118,190,.34)!important; color:#dde3ff!important;
}
body.theme-dark .cal-event[data-type="medicamento"],
body.theme-dark .week-item[data-type="medicamento"]{
  background:rgba(64,142,156,.16)!important; border-color:rgba(64,142,156,.34)!important; color:#d7f4ff!important;
}
/* Drag & Drop: feedback visual */
.appt[draggable="true"]{ cursor: grab; }
.appt.dragging{ opacity:.6; }

#clearAll.drop-ready{
  outline: 2px dashed #94a3b8;
  background: #eef2f7;
}
body.theme-dark #clearAll.drop-ready{
  outline-color:#3b4a6b;
  background:#1d2540;
}
